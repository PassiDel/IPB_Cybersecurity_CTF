## Forensic Analysis 02
> A system maintained by IPB has been showing abnormal behavior by generating broadcast traffic every few seconds.
> 
> The Machine IP is 192.168.10.150 .
> 
> Analyze the traffic and discover the flag.
> 
> In case you are connected by VPN, access the following machine to help you analyze the traffic generated by the system. Use the credentials provided for the VPN to access it.
> 
> ssh -Y -p 9090 your_user_name@192.168.10.14

To analyse the traffic, Wireshark and `tcpdump` over SSH is used.

```bash
$ ssh -Y -p 9999 192.168.10.14 -v -l $SSHUSER tcpdump -U -w - ! port 9999 | wireshark -i - -k
```

In Wireshark the filter `eth.src == 08:00:27:38:6b:da` is applied, to only show traffic that is coming from the MAC address of the abnormal machine. The traffic consist of purely ping packets, most of them are 42 bytes long with one packet of 82 bytes length every now and then. This longer packet contains ASCII text, base64 encoded.


```hex
0000   ff ff ff ff ff ff 08 00 27 38 6b da 08 00 45 00   ........'8k...E.
0010   00 44 00 01 00 00 40 01 e4 80 c0 a8 0a 96 c0 a8   .D....@.........
0020   0a 51 08 00 0d 5e 00 00 00 00 59 33 6c 69 5a 58   .Q...^....Y3liZX
0030   4a 6a 64 47 5a 6b 65 33 41 78 62 6a 5a 66 4d 47   JjdGZke3AxbjZfMG
0040   5a 66 5a 44 4d 30 4e 32 68 66 62 54 52 75 66 51   ZfZDM0N2hfbTRufQ
0050   3d 3d                                             ==

```

After decoding the flag can be seen.

```bash
$ echo "Y3liZXJjdGZke3AxbjZfMGZfZDM0N2hfbTRufQ==" | base64 -d
cyberctfd{p1n6_0f_d347h_m4n}
```
